{{layout '../../../../views/commonLayout.latte'}}
{{block title}}Corpus Annotation{{/block}}
{{block north}}
<div>
    <input id="corpus" name="corpus" type="text" style="width:200px; padding:5px" placeholder="{{_'Search Corpus'}}">
</div>
{{/block}}
{{block left}}
<div>
    <input id="idSentence" name="idSentence" type="text" style="width:200px; padding:5px" placeholder="#sentence">
</div>
<ul id="corpusTree"></ul>
{{/block}}
{{block controls}}{{/block}}
{{block center}}
    <div id="sentencesPane" region="center" style="width:100%;height:100%"   split="true" data-options="border:1"></div>
{{/block}}

{{block script}}
<script type="text/javascript">
    var annotation = {
        type: 'c',
        isMaster: {{$data->isMaster|noescape}},
        isSenior: {{$data->isSenior|noescape}},
        rgbColors: {{$data->colors|noescape}},
        layerType: {{$data->layerType|noescape}},
        instantiationType: {{$data->instantiationType|noescape}},
        instantiationTypeObj: {{$data->instantiationTypeObj|noescape}}
    };

    annotation.showDocument = function (document) {
        //$('#layersPane').html('');
        manager.doGet({{$manager->getURL('annotation/main/sentences')}} + '/' + document,'sentencesPane');
    }

    annotation.showSubCorpus = function (subCorpus) {
        //$('#layersPane').html('');
        manager.doGet({{$manager->getURL('annotation/main/sentences')}} + '/' + subCorpus,'sentencesPane');
    }

    $(function () {

        $('#corpus').textbox({
            //buttonText:{{_'Search Corpus'}},
            prompt: 'Search Corpus',
            buttonIcon: 'icon-search',
            //iconCls:'icon-search',
            iconAlign:'right',
            onClickButton: function() {
                $('#corpusTree').tree({queryParams: {corpus: $('#corpus').textbox('getValue')}});
            }
        });

        $('#idSentence').textbox({
            width:150,
            //iconCls:'icon-search',
            iconAlign:'right',
            buttonIcon: 'icon-search',
            prompt: '#sentence',
            onClickButton: function() {
                var idSentence = $('#idSentence').textbox('getValue');
                window.open({{$manager->getURL('annotation/main/annotation')}} + '/' + idSentence + '/0/' + annotation.type, '_blank');
            }
        });

        $('#corpusTree').tree({
            url: {{$manager->getURL('annotation/main/corpusTree')}},
            onSelect: function (node) {
                console.log(node);
                if (node.id.charAt(0) == 'd') {
                    annotation.showDocument(node.id);
                }
            }
        });
    });
</script>
{{/block}}
